(()=>{var I=async(d,u)=>{for(;!window.hasOwnProperty(d);)await new Promise(p=>setTimeout(p,1e3));u()},b=d=>new Promise(u=>setTimeout(u,d));(()=>{if(!document.querySelector('script[src*="youtube.com/iframe_api"]')){let o=document.createElement("script");o.src="https://www.youtube.com/iframe_api";let t=document.body.getElementsByTagName("script")[0];t.parentNode.insertBefore(o,t)}if(!document.querySelector('script[src*="vimeo.com/api"]')){let o=document.createElement("script");o.src="https://player.vimeo.com/api/player.js";let t=document.body.getElementsByTagName("script")[0];t.parentNode.insertBefore(o,t)}window.bc_video={vimeo:{},youtube:{},html:{}};let d=()=>String.fromCharCode(65+Math.floor(Math.random()*26))+Date.now(),u=(o,t,r,i)=>{t&&t.addEventListener("click",()=>{o.querySelectorAll(":scope > *").forEach(a=>{a.id.startsWith("vid_")||(a.style.display="none")});let c=window.bc_video[i][`${i==="vimeo"?"vm_":i==="youtube"?"yt_":"html_"}`+r];if(i==="youtube")return c.playVideo();c.play()})},p=async({player:o,playerId:t,playButton:r,type:i,wrapper:c,videoSource:a}={})=>{let n,s;return["youtube","vimeo"].includes(i)&&(c.setAttribute("data-bc-video-id",a),o.id=t,i==="youtube"&&(n=new YT.Player(t,{videoId:a,playerVars:{playsinline:1,rel:0,origin:window.location.origin,color:"white"},events:{onReady:l=>{window.bc_video.youtube["yt_"+a]=l.target}}})),i==="vimeo"&&(n=new Vimeo.Player(t,{id:a,dnt:!0}),await b(100),window.bc_video.vimeo={...window.bc_video.vimeo,["vm_"+a]:n}),s=a),i==="html"&&(s=t.split("_")[1],c.setAttribute("data-bc-video-id",s),o.id=t,o.innerHTML=`<video controls><source src="${encodeURI(a)}" type="video/mp4">Your browser does not support the video tag.</video>`,n=o.querySelector("video"),await b(100),window.bc_video.html={...window.bc_video.html,["html_"+s]:n}),u(c,r,s,i),n},L=(o,t)=>{o.forEach(async r=>{var _,T,S,q,E;let i=(_=r.target.querySelector("[data-bc-video-preview]"))==null?void 0:_.querySelector("video"),c=r.target.querySelector("[data-bc-video-player]"),a=r.target.querySelector("[data-bc-play-button]"),n=(T=r.target.dataset.bcVideoType)==null?void 0:T.trim().toLowerCase(),s=(S=r.target.dataset.bcVideoSource)==null?void 0:S.trim(),l=(q=r.target.dataset.bcVideoId)==null?void 0:q.trim(),g=["vimeo","youtube"].includes(n),m=n==="youtube",y=n==="vimeo",w=n==="html",f=e=>y?window.bc_video.vimeo["vm_"+e]:m?window.bc_video.youtube["yt_"+e]:w?window.bc_video.html["html_"+e]:null,v=async e=>{await e.play(),e.pause()},h=async e=>{(m?await e.getPlayerState()===0:y?await e.getEnded():w?e.currentTime>=e.duration:null)||(m?e.playVideo():e.play())};if(!(!n||!s)){if(r.isIntersecting){let e=f(l);if(!e){let C="vid_"+(w?d():s),V={player:c,playerId:C,playButton:a,type:n,videoSource:s,wrapper:r.target};m&&!window.onYTReady||y&&!((E=window.Vimeo)!=null&&E.Player)?await I(`${m?"onYTReady":"Vimeo"}`,async()=>{e=await p(V)}):e=await p(V),await b(200)}if(g){if(e!=null&&e.getCurrentTime&&await(e==null?void 0:e.getCurrentTime())>0){await v(i),await h(e);return}return i.play()}return w?(e==null?void 0:e.currentTime)>0?await h(e):i.play():void 0}if(g){let e=f(l);if(!e)return;e!=null&&e.getCurrentTime&&await(e==null?void 0:e.getCurrentTime())>0&&(y?e.pause():e.pauseVideo())}if(w){let e=f(l);if(!e)return;e.currentTime>0&&await v(e)}await v(i)}})},P=new IntersectionObserver(L,{threshold:.7});document.querySelectorAll("[data-bc-video]").forEach(o=>{var r;let t=(r=o.querySelector("[data-bc-video-preview]"))==null?void 0:r.querySelector("video");t&&(t.pause(),t.currentTime=0),setTimeout(()=>P.observe(o),1)})})();})();
